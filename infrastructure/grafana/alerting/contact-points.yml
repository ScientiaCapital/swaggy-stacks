apiVersion: 1

# Contact Points Configuration for Grafana Unified Alerting
# Defines notification channels for alert delivery

contactPoints:
  # Webhook Contact Point - Backend AlertManager Integration
  - orgId: 1
    name: webhook-alerts
    receivers:
      - uid: webhook_backend
        type: webhook
        settings:
          url: http://backend:8000/api/v1/alerts/webhook
          httpMethod: POST
          maxAlerts: 0
        disableResolveMessage: false

  # Email Contact Point - SMTP Notifications
  - orgId: 1
    name: email-alerts
    receivers:
      - uid: email_smtp
        type: email
        settings:
          addresses: ${ALERT_EMAIL_TO}
          singleEmail: false
        disableResolveMessage: false

  # Slack Contact Point - Critical Alerts
  - orgId: 1
    name: slack-critical
    receivers:
      - uid: slack_webhook
        type: slack
        settings:
          url: ${SLACK_WEBHOOK_URL}
          username: SwaggyStacks Alert Bot
          icon_emoji: ":warning:"
          title: "{{ .CommonLabels.alertname }}"
          text: |
            {{ range .Alerts }}
            *Alert:* {{ .Labels.alertname }}
            *Severity:* {{ .Labels.severity }}
            *Component:* {{ .Labels.component }}
            *Description:* {{ .Annotations.description }}
            *Status:* {{ .Status }}
            {{ end }}
        disableResolveMessage: false

  # PagerDuty Contact Point - For future integration
  - orgId: 1
    name: pagerduty-oncall
    receivers:
      - uid: pagerduty_integration
        type: pagerduty
        settings:
          integrationKey: ${PAGERDUTY_INTEGRATION_KEY}
          severity: critical
          class: trading_system
          component: alerting
        disableResolveMessage: false

  # Discord Contact Point - Team notifications
  - orgId: 1
    name: discord-team
    receivers:
      - uid: discord_webhook
        type: discord
        settings:
          url: ${DISCORD_WEBHOOK_URL}
          message: |
            **{{ .CommonLabels.alertname }}**
            Severity: {{ .CommonLabels.severity }}
            Component: {{ .CommonLabels.component }}
            {{ range .Alerts }}
            {{ .Annotations.description }}
            {{ end }}
          title: SwaggyStacks Alert
          use_discord_username: true
        disableResolveMessage: false

  # OpsGenie Contact Point - For future integration
  - orgId: 1
    name: opsgenie-oncall
    receivers:
      - uid: opsgenie_integration
        type: opsgenie
        settings:
          apiKey: ${OPSGENIE_API_KEY}
          apiUrl: https://api.opsgenie.com/v2/alerts
          message: "{{ .CommonLabels.alertname }}"
          description: |
            {{ range .Alerts }}
            {{ .Annotations.description }}
            {{ end }}
          autoClose: true
        disableResolveMessage: false

deleteContactPoints: []
